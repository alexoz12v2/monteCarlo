\label{chapter1}
\chapter{Richiami sull'elettromagnetismo e Radiometria}
\section{Radiazione Elettromagnetica}
La luce \`e un fenomeno fisico che si propaga come un'onda elettromagnetica ed interagisce con le altre sostanze come una particella. Dal punto di 
vista ondulatorio, una \textit{onda elettromagnetica} si propaga nel vuoto a velocit\`a costante $c$, la quale \`e correlata alla
\textit{permeabilit\`a magnetica nel vuoto} $\mu_0$ [\si{H/m}] e \textit{costante dielettrica nel vuoto} $\epsilon_0\ [\si{F/m}]$
\[ \epsilon_0 = \frac{1}{\mu_0 c^2} \]
mentre la \textit{Velocit\`a di fase} $v$ [\si{m/s}] \`e similmente legata alla \textit{permittivit\`a dielettrica del mezzo} $\epsilon$ e 
\textit{permeabilit\`a magnetica nel mezzo}
\[ \epsilon = \frac{1}{\mu v^2} \]
il rapporto tra le costanti nel mezzo e le costanti nel vuoto definiscono \textit{permittivit\`a relativa} $\epsilon_r$ e 
\textit{permeabilit\`a relativa} $\mu_r$\par
%
\begin{figure}[t]
	% ELECTROMAGNETIC SPECTRUM
	\begin{tikzpicture}[xscale=0.8, yscale=1.2]
	  \def\h{1}
	  \def\radio{-4}
	  \def\micro{0}
	  \def\IR{3}
	  \def\red{6.10}  % log(700e-9) = -6.15490196
	  \def\blue{6.40} % log(400e-9) = -6.39794001
	  \def\UV{6.40}
	  \def\Xray{8}
	  \def\gamm{11}
	  \def\last{12}
	  \def\radiof{-5}
	  \def\dx{0.6}
	  \def\yE{-1.1*\h}
	  
	  \def\tick#1#2#3{\draw[thick,#2] (#1+.08) --++ (0,-.16) node[below=-2pt,scale=1] {\strut #3};}
	  \def\ticka#1#2#3{\draw[thick,#2] (#1+.08) --++ (0,-.16) node[above=2pt,scale=1] {\strut #3};}
	  
	  % MIDDLE
	  \fill[green!60!black!10] (\radio-0.82*\dx,0) rectangle (\IR,\h);
	  \fill[yellow!60!black!10] (\micro,0.18*\h) rectangle (\IR,0.8*\h);
	  \fill[red!60!black!10] (\IR,0) rectangle (\red,\h);
	  \fill[blue!60!violet!80!black!10] (\UV,0) rectangle (\Xray,\h);
	  \fill[blue!50!black!15] (\Xray,0) rectangle (\gamm,\h);
	  \fill[blue!40!black!25] (\gamm,0) rectangle (\last+0.8*\dx,\h);
	  \shade[shading=rainbow,shading angle=-90] (\red,0) rectangle (\blue,\h);
	  \node at ({(\radio+\micro)/2},\h/2) {\strut radio};
	  \node at ({(\micro+\IR)/2},   \h/2) {\strut micro};
	  \node at ({(\IR+\red)/2},     \h/2) {\strut IR};
	  %\node at (\red,  \h/2) {red};
	  %\node at (\red,  \h/2) {blue};
	  \node at ({(\UV+\Xray)/2},    \h/2) {\strut UV};
	  \node at ({(\Xray+\gamm)/2},  \h/2) {\strut X ray};
	  \node at ({(\gamm+\last+0.8*\dx)/2},  \h/2) {\strut gamma};
	  
	  % WAVELENGTH
	  \draw[->,thick,wavecol] (\last+\dx,\h) -- (\radio-1.5*\dx,\h) node[above left=-3,scale=1.1] {$\lambda$ [\si{m}]};
	  \foreach \x [evaluate={\i=int(-\x)}] in {\radio,...,\last}{
	    \ifthenelse{\i=0}{ \ticka{\x,\h}{wavecol}{$1$} }
	                     { \ticka{\x,\h}{wavecol}{$10^{\i}$} }
	  }
	  \node[wavecol,scale=1] at (-3,1.71*\h) {\strut km};
	  \node[wavecol,scale=1] at ( 0,1.71*\h) {\strut m};
	  \node[wavecol,scale=1] at ( 3,1.71*\h) {\strut mm};
	  \node[wavecol,scale=1] at ( 6,1.71*\h) {\strut $\si{\mu m}$};
	  \node[wavecol,scale=1] at ( 9,1.71*\h) {\strut pm};
	  \node[wavecol,scale=1] at (12,1.71*\h) {\strut fm};
	  %\node[wavecol,scale=1] at (15,1.71*\h) {\strut am};
	  
	  % FREQUENCY
	  % log(f) = log(c) - log(lambda)
	  % log(c) = log(2.997e8) = 8.4766867429
	  \draw[->,thick,freqcol] (\radio-\dx,0) -- (\last+1.5*\dx,0) node[below right=-3,scale=1.1] {$f$ [\si{Hz}]};
	  \foreach \x [evaluate={\i=int(\x+9);\X=\x+0.53}] in {\radiof,...,\last}{
	    \tick{\X,0}{freqcol}{$10^{\i}$}
	  }
	  %\node[freqcol,scale=1] at (-8.47+ 3,-0.65*\h) {\strut kHz};
	  \node[freqcol,scale=1] at (-8.47+ 6,-0.71*\h) {\strut MHz};
	  \node[freqcol,scale=1] at (-8.47+ 9,-0.71*\h) {\strut GHz};
	  \node[freqcol,scale=1] at (-8.47+12,-0.71*\h) {\strut THz};
	  \node[freqcol,scale=1] at (-8.47+15,-0.71*\h) {\strut PHz};
	  \node[freqcol,scale=1] at (-8.47+18,-0.71*\h) {\strut EHz};
	  
	  % ENERGY
	  % log(E) = log(hc) - log(lambda)
	  % log(hc) = log(2.997e8*4.135e-15) = -5.9068377432
	  \draw[->,thick,enercol] (\radio-\dx,\yE) -- (\last+1.5*\dx,\yE) node[below right=-3,scale=1.1] {$E$ [\si{eV}]};
	  \foreach \x [evaluate={\i=int(\x-6);\X=\x-0.09}] in {\radio,...,\last}{
	    \ifthenelse{\i=0}{ \tick{\X,\yE}{enercol}{$1$} }
	                     { \tick{\X,\yE}{enercol}{$10^{\i}$} }
	  }
	  %\node[enercol,scale=1] at (5.91-15,\yE-0.69*\h) {\strut feV};
	  %\node[enercol,scale=1] at (5.91-12,\yE-0.69*\h) {\strut peV};
	  \node[enercol,scale=1] at (5.91- 9,\yE-0.69*\h) {\strut neV};
	  \node[enercol,scale=1] at (5.91- 6,\yE-0.69*\h) {\strut $\si{\mu eV}$};
	  \node[enercol,scale=1] at (5.91- 3,\yE-0.69*\h) {\strut meV};
	  \node[enercol,scale=1] at (5.91+ 0,\yE-0.69*\h) {\strut  eV};
	  \node[enercol,scale=1] at (5.91+ 3,\yE-0.69*\h) {\strut keV};
	  \node[enercol,scale=1] at (5.91+ 6,\yE-0.69*\h) {\strut MeV};
	  %\node[enercol,scale=1] at (5.91+9,\yE-0.69*\h) {\strut GeV};
	  
	\end{tikzpicture}
	\caption{spettro delle radiazioni elettromagnetiche, delle quali quelle visibili costituiscono una piccola parte.}
	\label{chapter1:spectrum}
\end{figure}
%
Come osservi in figura \ref{chapter1:spectrum}, un'onda monocromatica \`e caratterizzata da
\begin{alignat}{2}
	&\text{frequenza di oscillazione $\nu$ [\si{Hz}] e periodo $T$ [\si{s}]} & \nu = \frac{1}{T} \\
	&\text{frequenza angolare $\omega$ [\si{rd/s}]} & \omega = 2\pi\nu = \frac{2\pi}{T} \\
	&\text{lunghezza d'onda $\lambda$ [\si{m}], nel vuoto e nel mezzo} & \lambda_0 = cT = \frac{c}{\nu} \\
	& & \lambda = vT = \frac{v}{\nu}
\end{alignat}
La luce visibile all'\textit{occhio umano} corrisponde al sottoinsieme dello spettro $[383, 783]\ \si{THz}$, equivalentemente $[783, 383]\ \si{nm}$\par
Le propriet\`a dell'onda in un mezzo relative alle propriet\`a dell'onda nel vuoto sono determinate dall'\textit{indice di rifrazione} (IOR), dipendente
dalla lunghezza d'onda
\begin{equation}
	\eta = \sqrt{\mu_r \epsilon_r} = \sqrt{\frac{\mu \epsilon}{\mu_0 \epsilon_0}} = \frac{c}{v} 
\end{equation}
\textit{radiazione elettromagnetica} \`e composta da campo elettrico $\overrightarrow{E}$ ed un campo magnetico 
$\overrightarrow{B}$ oscillanti in fase, perpendicolari tra loro e alla direzione di propagazione $\hat{k}$ (Figura \ref{chapter1:EMwave}). 
Le propriet\`a di tali campi sono descritti in funzione della posizione $\overrightarrow{r}$ e tempo $t$ dalle \textit{Equazioni di Maxwell}
\cite{pegoraro}\par
Propriet\`a importante per un'onda elettromagnetica \`e la sua \textit{polarizzazione}, la quale specifica l'orientemento nello spazio del campo
elettrico (per convenzione) nella propagazione nello spazio dell'onda. Il campo elettrico pu\`o avere direzione fissa o essere rotante in base ad una
data funzione \cite{rad-phot}. Esso \`e importante per le propriet\`a ottiche dei materiali, discussi in seguito. Gli stati di polarizzazione 
fondamentali che citiamo sono \textit{polarizzatione lineare}, nella quale il campo elettromagnetico \`e confinato in un piano dello spazio, 
\textit{polarizzazione circolare}, nella quale il vettore campo elettrico descrive una circonferenza nella sua rotazione con velocit\`a angolare 
costante, \textit{polarizzazione ellittica}, la quale \`e una combinazione tra polarizzazoini circolari e planari. Con il termine 
\textit{polarizzazione casuale} ci riferiamo invece a luce con polarizzazione ellittica, le cui caratteristiche (eccentricit\`a, velocita angolare) 
sono casuali, diverso da \textit{luce non polarizzata} nella quale le caratteristiche (modulo e orientamento) del campo elettrico sono casuali.
Un raggio luminoso pu\`o essere costituito dalla sovrapposizione di pi\`u radiazioni aventi differente stato di polarizzazione. Ci sono diversi metodi 
per scomporre tali componenti e analizzarle \cite{hecht}.\par
Una delle propriet\`a ottiche cangianti con lo stato di polarizzazione \`e la \textit{Riflettanza}, la quale ha espressioni note differenti per 
radiazione linearmente polarizzata con piano di vibrazione $\parallel$ e $\perp$ al piano di incidenza.\par
Tratteremo principalmente luce non polarizzata, la quale \`e una buona approssimazione considerando che la luce del cielo, che si propaga nell'
atmosfera, \`e parzialmente polarizzata.
\begin{figure}[t]
	% Electromagnetic wave - colored
	\begin{tikzpicture}[x=(-15:1.2), y=(90:1.0), z=(-150:1.0),
	                    line cap=round, line join=round,
	                    axis/.style={black, thick,->},
	                    vector/.style={>=stealth,->}]
	  \large
	  \def\A{1.5}
	  \def\nNodes{5} % use even number
	  \def\nVectorsPerNode{8}
	  \def\N{\nNodes*40}
	  \def\xmax{\nNodes*pi/2*1.01}
	  \pgfmathsetmacro\nVectors{(\nVectorsPerNode+1)*\nNodes}
	  
	  \def\vE{{\color{myblue}\mathbf{E}}}
	  \def\vB{{\color{myred}\mathbf{B}}}
	  \def\vk{\mathbf{\hat{k}}}
	  
	  \def\drawENode{ % draw E node and vectors with some offset
	    \draw[myblue,very thick,variable=\t,domain=\iOffset*pi/2:(\iOffset+1)*pi/2*1.01,samples=40]
	      plot (\t,{\A*sin(\t*360/pi)},0);
	    \foreach \k [evaluate={\t=\k*pi/2/(\nVectorsPerNode+1);
	                           \angle=\k*90/(\nVectorsPerNode+1);}]
	                in {1,...,\nVectorsPerNode}{
	      \draw[vector,myblue!50]  (\iOffset*pi/2+\t,0,0) -- ++(0,{\A*sin(2*\angle+\iOffset*180)},0);
	    }
	  }
	  \def\drawBNode{ % draw B node and vectors with some offset
	    \draw[myred,very thick,variable=\t,domain=\iOffset*pi/2:(\iOffset+1)*pi/2*1.01,samples=40]
	      plot (\t,0,{\A*sin(\t*360/pi)});
	    \foreach \k [evaluate={\t=\k*pi/2/(\nVectorsPerNode+1);
	                           \angle=\k*90/(\nVectorsPerNode+1);}]
	                in {1,...,\nVectorsPerNode}{
	      \draw[vector,myred!50]  (\iOffset*pi/2+\t,0,0) -- ++(0,0,{\A*sin(2*\angle+\iOffset*180)});
	    }
	  }
	  
	  % MAIN AXES
	  \draw[axis] (0,0,0) -- ++(\xmax*1.1,0,0) node[right] {$x$};
	  \draw[axis] (0,-\A*1.4,0) -- (0,\A*1.4,0) node[right] {$y$};
	  \draw[axis] (0,0,-\A*1.4) -- (0,0,\A*1.4) node[above left] {$z$};
	  
	  % SMALL AXES
	  \def\xOffset{{(\nNodes-2)*pi/2}}
	  \def\yOffset{\A*1.2}
	  \def\zOffset{\A*1.2}
	  \draw[axis,black] (\xOffset,\yOffset,-\zOffset) -- ++(\A*0.6,0,0) node[right,align=center] {$\mathbf{\hat{k}}$}; %\\propagation
	  \draw[axis,myblue]  (\xOffset,\yOffset,-\zOffset) -- ++(0,\A*0.6,0) node[right] {$\mathbf{E}$};
	  \draw[axis,myred]   (\xOffset,\yOffset,-\zOffset) -- ++(0,0,\A*0.6) node[above left] {$\mathbf{B}$};
	  
	  % equation
	  \node[above right] at (\xOffset,-0.5*\yOffset,4*\zOffset)
	    {$\begin{aligned}
	      \vE &= {\color{myblue}\mathbf{E_0}}\sin(\vk\cdot\mathbf{x}-c_0t)\\
	      \vB &= {\color{myred} \mathbf{B_0}}\sin(\vk\cdot\mathbf{x}-c_0t)\\
	      \end{aligned}$};
	  \node[below right] at (\xOffset,-0.5*\yOffset,4*\zOffset)
	    {$\vE\cdot\vk = 0,\;\; \vB\cdot\vk = 0,\;\; \vB = \frac{1}{c_0}\vk\times\vE$};
	  
	  % draw (anti-)nodes
	  \foreach \iNode [evaluate={\iOffset=\iNode-1;}] in {1,...,\nNodes}{
	    \ifodd\iNode \drawBNode \drawENode % E overlaps B
	    \else        \drawENode \drawBNode % B overlaps E
	    \fi
	  }
	\end{tikzpicture}
	\caption{Illustrazione di un'onda elettromagnetica 1D che si propaga in direzione $\hat{k}$ con polarizzazione lineare}
	\label{chapter1:EMwave}
\end{figure}
Il modello fornito dall'elettrodinamica della radiazione luminosa \`e troppo complesso per essere simulato in tempo reale da dei sistemi di rendering.
Allora, il pi\`u delle volte si opta per l'utilizzo di un nuovo modello operativo della luce, orientato 
alla misurazione piuttosto che alla formulazione da primi principi, nel quale ci disinteressiamo dell'origine fisica della luce e misuriamo
l'energia aggregata trasportata dai fotoni contenuti in una radiazione. Tale scienza \`e la \textit{Radiometria} (sezione \nameref{radiometria})\par
\section{Introduzione all'assorbimento di radiazione}
\begin{table}[tb]
	\begin{tabular}{cccp{6cm}}
		\toprule
		Materiale & $\lambda$ [\si{nm}] & $\kappa_a$ [\si{cm^{-1}}] & Osservazioni \\
		\midrule
		Vapore Acqueo & $10.6\cdot 10^3$ (infrarossi) & $1.5$ & Ogni centimetro la luce che passa per vapore acqueo l'1.5\% dell'energia \`e assorbita\\
		Vetro & $550$ (verde) & $0.1$ & Cos\`i basso che \`e praticamente trascurabile. Il vetro \`e praticamente trasparente alla luce \\
		Ferro & $400$ (violetto) & $2.5\cdot 10^4$ & Assorbe fortemente la luce violetta, motivo per cui appare grigio scuro \\
		Clorofilla & $680$ (rosso) & $10^5$ & Assorbe fortemente luce rossa, motivo per cui appare verde \\
		Diossido di Carbonio & $4.3\cdot 10^3$ (infrarossi) & $7$ & Assorbe fortemente radiazione infrarossa, motivo per cui contribuisce al riscaldamento globale \\
		\bottomrule
	\end{tabular}
	\label{chapter1:absorption-table}
	\caption{Esempi di coefficiente di assorbimento per alcuni materiali a date lunghezze d'onda}
\end{table}
Quando la luce passa per un mezzo, parte di essa viene rifratta e riflessa (capitolo 3). In alcuni materiali\footnote{come i metalli}, quando la 
luce passa attraverso il mezzo \`e assorbita, e il wavelength-dependent \textit{coefficiente di assorbimento} $\kappa_a$ [\si{m^{-1}}], il quale 
indica la percentuale di energia di onda elettromagnetica assorbita, per una data lunghezza d'onda, nella propagazione nel materiale \cite{pegoraro}.
Alcuni esempi di coefficiente di assorbimento sono mostrati in Tabella \nameref{chapter1:absorption-table}\par
Combinando indice di rifrazione $\eta$ e indice di assorbimento $\kappa_a$ otteniamo una quantit\`a che descrive completamente come si comporta la 
radiazione nella propagazione nel mezzo, contando anche il fenomeno dell'assorbimento, definito come \textit{indice di rifrazione complesso}
\begin{equation}
	\underline{\eta} = \eta + \iu\kappa
\end{equation}
dove $\kappa = \frac{\kappa_a}{2k_0}$ \`e l'\textit{indice di assorbimento} della superficie, $k_0$ numero d'onda.
\footnotetext{In fotometria e radiometria \textit{intensit\`a} ha un altro significato: essa \`e la potenza radiante o luminosa per unit\`a di 
	angolo solido. In Ottica e Termodinamica, \textit{intensit\`a} essa \`e associata alla potenza media nel periodo per unit\`a di superficie, come 
	in questo caso, altre volte all'intensit\`a radiante o luminosa, oppure all'irradianza o alla radianza. Per Radiometria, vedi \nameref{radiometria}}
\section{Radiometria}
\label{radiometria}
Branche dell'ottica prese come riferimento dal physically based rendering sono la \textit{Radiometria} e \textit{Radiative Transfer}.
La \textit{Radiometria} \`e il modello matematico per studiare e misurare la propagazione delle radiazioni elettromagnetiche. In tale modello, ci 
disinteressiamo degli aspetti ondulatori delle onde elettromagnetiche e guardiamo la radiazione come energia fluente nello spazio. Ci\`o suggerisce
che la Radiometria opera a livello dell'ottica geometrica, assumendo dunque propagazione rettilinea della luce e trascurando fenomeni dovuti alla 
natura ondulatoria della radiazione. Si considerado solamente gli effetti della riflessione, trasmissione, scattering ed assorbimento.
In particolare, le assunzioni fatte sono le seguenti[\cite{pharr}]:
\begin{altDescription}{chapter1:radiometria-assunzioni}
	\item[Linearit\`a] La combinazione lineare di pi\`u input ad un sistema ottico \`e pari alla combinazione lineare degli effetti dei singoli input
	\item[Conservazione dell'energia] Quando una fonte di radiazioni scatters da una superficie o mezzo trasmissivo, gli \textit{scattering events}
		[\cite{pegoraro}], non possono produrre pi\`u energia di quella iniziale
	\item[No polarizzazione] Ignoriamo la polarizzazione del campo elettromagnetico di una radiazione, rendendo l'unica propriet\`a rilevante di
		una radiazione la sua \textit{Distribuzione Spettrale} [\nameref{chapter2}]
	\item[No fluorescenza o fosforescenza] Il comportamento della radiazione ad una lunghezza d'onda \`e indipendente dal comportamento della 
		radiazione ad altre lunghezze d'onda
	\item[A regime] Il \textit{Light Field} (\nameref{chapter1:radianza}) nell'ambiente \`e assunto a regime, indipendente dal tempo. Nota che la 
		fosforescenza viola anche questo presupposto
\end{altDescription}
Il \textit{Radiative Transfer}, qui solo accennato, \`e lo studio dei fenomeni legati al trasferimento di energia radiante, basato sulla radiometria,
ed utilizzato nella computer grafica per introdurre fenomeni legati all'ottica fisica e modellare la propagazione in un mezzo diverso dal vuoto.\par
Le unit\`a fondamentali della radiometria sono riassunte nella tabella \ref{chapter1:radiometric-quantities}
\begin{table}[tb]
	\begin{tabularx}{\linewidth}{cccY}
		\toprule
		Quantit\`a & Simbolo & unit\`a S.I. & Note \\
		\midrule
		\Gls{Energia Radiante} & $Q_e$ & \si{J} & Energia aggregata di tutti i fotoni in una radiazione elettromagnetica\\
		\Gls{Flusso Radiante}  & $\Phi_e$ & \si{W} & Energia Radiante \textit{emessa, riflessa, trasmessa, incidente}, per unit\`a di tempo\\
		\Gls{Intensita Radiante} & $I_{e,\Omega}$ & \si{W/sr} & Flusso Radiante emesso, riflesso, trasmesso, per uni\`a di angolo solido\\
		\Gls{Irradianza} & $E_e$ & \si{W/m^2} & Flusso Radiante incidente per unit\`a di area\\
		\Gls{Emittanza Radiante} & $M_e$ & \si{W/m^2} & Flusso Radiante emesso per unit\`a di area\\
		\Gls{Radiosita} & $J_e$ & \si{W/m^2} & Flusso Radiante \textit{uscente} (emesso, riflesso e trasmesso) per unita di area\\
		\Gls{Radianza} & $L_{e,\Omega}$ & \si{W/(sr.m^2)} & Flusso Radiante emesso, riflesso, trasmesso, incidente da/su una superficie, per unit\`a di 
			angolo solido per unita di \textit{area proiettata}\\
		\bottomrule
	\end{tabularx}
	\caption{nomenclatura e misure delle quantit\`a radiometriche per noi rilevanti}
	\label{chapter1:radiometric-quantities}
\end{table}
\begin{definitionS}
	L'\textit{Energia Radiante} $Q_e$ \`e l'energia aggregata di tutti i fotoni, ognuno ad una particolare lunghezza d'onda con contributo energetico
	diverso, \textit{verso/attraverso/da} una superficie in un dato intervallo di tempo\par
	Ciascuno di questi fotoni trasporta energia pari all'Equazione di plank-Einstein $Q_\lambda=\frac{hc}{\lambda}$
\end{definitionS}
\begin{definitionS}
	L'\textit{Energia Radiante Spettrale} $Q_{e,\lambda}$\footnotemark{} \`e il contributo di una singola lunghezza d'onda all'energia radiante 
	complessiva
	\[ Q_{e,\lambda}= \frac{\partial Q_e}{\partial\lambda} \]
\end{definitionS}
\footnotetext{Le grandezze spettrali possono essere espresse in funzione della lunghezza d'onda $\lambda$ ( e.g. $Q_{e,\lambda}$ ) o del suo inverso, la
	frequenza ( e.g. $Q_{e,\nu}$ )}
Data l'assunzione di sistema a regime, siamo interessati a misurare l'energia radiante in un istante piuttosto che per un periodo definito di tempo.
Dunque definiamo
\begin{definitionS}
	Il \textit{Flusso Radiante} $\Phi_e$ \`e la quantit\`a di energia radiante passante attraverso una superficie per unit\`a di tempo
	\[ \Phi_e = \frac{\partial Q_e}{\partial t} \]
	La cui derivata rispetto alle frequenze fornisce il \textit{Flusso Radiante Spettrale}
	\[ \Phi_{e,\lambda} = \frac{\partial\Phi_e}{\partial\lambda} \]
\end{definitionS}
Ogni misurazione di un flusso richiede un area ben definita per attribuirle senso. Nei sistemi di rendering, non \`e insolito invece compiere delle 
misure "puntuali" di un flusso radiante, cio\`e \textit{flusso radiante per unit\`a di area}.
\begin{definitionS}
	La densit\`a superficiale del flusso radiante (energia per unit\`a di tempo, per unit\`a di superficie) \`e detta \textit{Irradianza} $E_e$ se tale 
	flusso \`e entrante la superficie, \textit{Emittanza Radiante} $M_e$ se emesso dalla superficie, \textit{Radiosit\`a} $J_e$ se uscente (emesso, 
	riflesso o trasmesso) dalla superficie
	\[ E_e | J_e | M_e = \frac{\partial\Phi_e}{\partial A} \]
	La cui derivata rispetto alle frequenze fornisce la rispettiva grandezza spettrale
	\[ E_{e,\lambda} | J_{e,\lambda} | M_{e,\lambda} = \frac{\partial E_e | J_e | M_e}{\partial\lambda} \]
	Si noti infine che l'Irradianza, per definizione, \`e pari alla media temporale in un periodo del vettore di Pointing perpendicolare alla 
	superficie \[ E_e = \langle |\vec{S}| \rangle \]
\end{definitionS}
Piuttosto che concentrarci su un unico punto della superficie, possiamo concentrarci su una singola direzione, considerando il flusso radiante per 
unit\'a di angolo solido.
\begin{definitionS}
	La \textit{Intensit\`a Radiante} $I_{e,\Omega}$ \`e la densit\`a angolare del flusso radiante emesso, riflesso, trasmesso o incidente da/verso un 
	punto dello spazio e propagante lungo una direzione specificati
	\[ I_{e,\Omega} = \frac{\partial\Phi_e}{\partial\Omega} \]
	L'\textit{Intensit\`a (Radiante) Spettrale} \`e l'intensit\`a radiante per unit\`a di lunghezza d'onda
	\[ I_{e,\Omega,\lambda} = \frac{\partial I_{e,\Omega}}{\partial\lambda} \]
\end{definitionS}
Tale grandezza \`e utile per la modellazione, ad esempio, delle sorgenti luminose puntuali omnidirezionali, le quali distribuiscono il loro 
flusso radiante emesso, inversamente proporzionale al quadrato della distanza dalla sorgente, in modo uniforme il ogni direzione 
$I_{e,\Omega} = \frac{\Phi_e}{4\pi}$.\par
La descrizione pi\`u granulare dell'energia emessa da un'onda elettromagnetica \`e fornita dalla \textit{Radianza}, definita come
\label{chapter1:radianza}
\begin{definitionS}
	La \textit{Radianza} $L_{e,\Omega}$ \`e definita come flusso radiante emesso, riflesso, trasmesso o incidente da/su una dato punto della 
	superficie, da/verso una data direzione, dunque per unit\`a di angolo solido per unit\`a di area \textit{proiettata}
	\[ L_{e,\Omega} = \frac{\partial^2\Phi_e}{\partial\Omega\partial(A\cos\theta)} \]
	dove $\theta$ angolo tra la direzione perpendicolare alla superficie sul punto considerato e la direzione del flusso
\end{definitionS}
Significativa ai nostri fini \`e la relazione inversa che sussiste tra Irradianza e Radianza, che sfrutteremo per definire l'equazione del rendering
\begin{align}
	E_e(\vec{p}) &= \int_\Omega L_{e,\Omega}(\vec{p},\hat{\omega})\cos\theta\mathrm{d}\hat{\omega}\footnotemark 
				 &= \int_{\theta_1}^{\theta_2} \int_{\varphi_1}^{\varphi_2} L_{e,\Omega}(\vec{p}, \theta, \varphi)
						\cos\theta\sin\theta\mathrm{d}\theta\mathrm{d}\varphi
\end{align}
\footnotetext{Si noti la distinzione tra $\hat\omega$ e $\mathrm{d}\hat\omega$. Il primo \`e un vettore unitario dal punto $\vec{p}$ ad un 
	punto della porzione di sfera unitaria costituente il dominio di integrazione, il secondo \`e un elemento di angolo angolo solido. 
	Un angolo solido \`e  un  numero adimensionale rappresentante la porzione di area di sfera coperta, nell'intervallo $[0,4\pi]$.
	Il suo differenziale rappresenta un piccolo quadratino della superficie della sfera, spesso approssimato ad un quadrato ai fini 
	di dimostrazioni geometriche}
\subsection{Propriet\`a Particolari}
Ciascuna di queste grandezze assume il suo ruolo in un sistema di rendering e possiede propriet\`a particolari. Ad esempio, il \textit{Flusso Radiante}
pu\`o essere utilizzato al fine di poter campionare una fonte luminosa con probabilit\`a proporzionale alla potenza emessa dalla sua superficie.\par
Relazione significativa che coinvolge l'\textit{Irradianza} \`e la \textit{Legge del coseno di Lambert}
\begin{definitionS}
	La \textit{Legge del coseno di Lambert} afferma che L'\textit{Intensit\`a Radiante}\footnote{o Intensit\`a Luminosa} osservata da un 
	\textit{Radiatore Lambertiano}/verso una \textit{Superficie Lambertiana} \`e direttamente proporzionale all'angolo $\theta$ tra l'osservatore e la
	normale alla superficie\footnote{da cui $E = E_0\cos\theta$}
	\begin{equation*}
		I = I_0\cos\theta
	\end{equation*}
\end{definitionS}
Dove per \textit{Radiatore Lambertiano} si intende ogni superficie radiante la cui radianza emessa \`e indipendente dalla direzione considerata, mentre
per \textit{Superficie Lambertiana} si intende ogni superficie che obbedisce alla legge del coseno, e riflette radianza incidente in tutte le direzioni
in modo uniforme, e tale tipologia di riflessione \`e detta \textit{Riflessione diffusa}, che riprendiamo in seguito.\par 
La \textit{Radiosit\`a}, la quale pu\`o essere scomposta in 
\begin{equation*}
	J_e(\vec{p}) = \frac{\partial \Phi_e}{\partial A} = M_e(\vec{p}) + J_{e,r}(\vec{p}) + J_{e,t}(\vec{p})
\end{equation*}
dove 
\begin{itemize}[topsep=0pt, noitemsep]
	\item $M_e$ Emittanza Radiante dalla superficie nel punto $\vec{p}$, componente emessa della radiosit\`a
	\item $J_{e,r}$ Componente riflessa della radiosit\`a
	\item $J_{e,t}$ Componente trasmessa della radiosit\`a, nullo per superfici opache
\end{itemize}
\`e la grandezza protagonista dell'algoritmo di rendering deterministico che porta il suo nome, \textit{Metodo della radiosit\`a}, nel quale \`e 
possibile, mediante la risoluzione di un sistema di equazioni, renderizzare un scena contenenti superfici caratterizzate da riflessione diffusa.\par
Definiamo brevemente \textit{Etend\`ue}
\begin{definitionS}
	\textit{Etendue} \`e una propriet\`a geometrica di un sistema ottico che quantifica quanto spazio la luce occupa in termini di area e angolari.
	Essa quantifica dunque il throughput di una sorgente luminosa. Matematicamente, essa \`e pari al prodotto tra l'area della sorgente/osservatore 
	e l'angolo solido della sorgente/osservatore che tale area sottende, tenendo conto del mezzo in cui la luce si propaga (indice di rifrazione)
	\[ \mathrm{d}G = \eta^2\langle \hat{n_s},\hat{\omega} \rangle\mathrm{d}A(\vec{p})\mathrm{d}\hat{\omega}\]
\end{definitionS}
Considerando una sorgente luminosa $\Sigma$, e un osservatore $S$, entrambi superfici separate da un mezzo con indice di rifrazione $\eta$, omogeneo,
isotropico, senza perdite (cio\`e in assenza di scattering\footnote{anche detto mezzo trasparente} e assorbimento) e distanti $d$, l'etendue \`e dato da
\[ \mathrm{d}G_\Sigma = \eta^2\mathrm{d}\Sigma\cos\theta_\Sigma\mathrm{d}\omega_\Sigma 
					  = \eta^2\mathrm{d}\Sigma\cos\theta_\Sigma\frac{\mathrm{d}S\cos\theta_S}{d^2} \]
per ogni punto della superficie della sorgente. Im modo simile, l'etendue da un particolare punto della superficie di osservazione (e.g. una lente, o
un camera film) \`e dato da
\[ \mathrm{d}G_S = \eta^2\mathrm{d}S\cos\theta_S\mathrm{d}\omega_S 
				 = \eta^2\mathrm{d}S\cos\theta_S\frac{\mathrm{d}\Sigma\cos\theta_\Sigma}{d^2}\]
Da cui si osserva che $\mathrm{d}G_\Sigma = \mathrm{d}G_S$, cio\`e che \textit{L'etendue}, il throughput di una sorgente, \textit{si conserva}.\par
Dalla conservazione dell'etendue segue la \textit{Conservazione della radianza di base}, in quanto, dalla definizione di \gls{Radianza}
\begin{align} \label{chapter1:basicRadiance}
	L_{e,\Omega}(\vec{p}, \hat{\omega}) &= \frac{\partial^2\Phi_e}{\langle\hat{n},\hat{\omega}\rangle\partial A(\vec{p})\partial\hat{\omega}} 
						   = \eta^2\frac{\partial^2\Phi_e}{\mathrm{d}G(\vec{p},\hat{w})}\\
	\frac{L_{e,\Omega}(\vec{p}, \hat{\omega})}{\eta^2} &= \frac{\partial^2\Phi_e}{\mathrm{d}G(\vec{p},\hat{w})}
		= \frac{\partial^2\Phi_e}{\mathrm{d}G(\vec{q},-\hat{w})} = \frac{L_{e,\Omega}(\vec{q}, -\hat{\omega})}{\eta^2}
\end{align}
In quanto la potenza e l'etendue si conservano, anche il rapporto tra radianza e indice di rifrazione, detto radianza di base, si conserva nella 
propagazione in un mezzo ideale.\par
\subsection{Radianza incidente ed uscente}
La radianza $L$ \`e generalmente una funzione discontinua sulle superfici di separazione tra due mezzi, dette interfacce.
\begin{align}
	L^+ &= \lim_{t\rightarrow 0^+} L(\vec{p}+t\hat{n},\hat{\omega})\\
	L^- &= \lim_{t\rightarrow 0^-} L(\vec{p}+t\hat{n},\hat{\omega})
\end{align}
dunque, piuttosto che lavorare con un unica funzione discontinua, si preferisce distinguere tra \textit{radianza incidente} $L_i$ e 
\textit{radianza uscente}\footnote{emessa, riflessa, trasmessa}.
\begin{align}\label{chapter1:radiometry:incidentOutgoingRadiances}
	L_i(\vec{p},\hat{\omega})&=\left\{
	\begin{aligned}
		L^+(\vec{p},-\hat{w}),\text{ }\langle\omega,\hat{n}\rangle>0\\
		L^-(\vec{p},-\hat{w}),\text{ }\langle\omega,\hat{n}\rangle<0
	\end{aligned}\right.\footnotemark{}\\
	L_o(\vec{p},\hat{\omega})&=\left\{
	\begin{aligned}
		L^+(\vec{p},\hat{w}),\text{ }\langle\omega,\hat{n}\rangle>0\\
		L^-(\vec{p},\hat{w}),\text{ }\langle\omega,\hat{n}\rangle<0
	\end{aligned}\right.
\end{align}
\footnotetext{Si noti come per convenzione, la radianza incidente la direzione $\hat{\omega}$ sia uscente dal punto $vec{p}$, nonostante 
	il flusso radiante abbia direzione opposta. In altre parole, la radianza incidente ha come argomento la direzione di provenienza del flusso}
Si noti che in punti dello spazio non giacenti su una superficie, la radianza \`e invece continua, $L^+=L^-$, da cui
\begin{equation}
	L_o(\vec{p},\hat{\omega}) = L_i(\vec{p},-\hat{\omega})
\end{equation}
Si pu\`o riscrivere la conservazione della radiaza di base in termini della radianza incidente e radianza uscente
\begin{equation}
	\frac{L_o(\vec{p}, \hat{\omega})}{\eta^2_1} = \frac{L_i(\vec{q}, \hat{\omega})}{\eta^2_2}
\end{equation}
\section{Radiazione di Corpo Nero}
Tutti i corpi con temperatura superiore allo zero assoluto emettono radiazione, in quantit\`a proporzionale alla temperatura assoulta in quanto essa 
corrisponde allo stato di agitazione delle molecole, causando accelerazione di elettroni e protoni degli atomi costituenti, portando all'emissione 
di campo elettromagnetico secondo le equazioni di Maxwell. Tale flusso radiante spettrale emesso costituisce una \textit{Spectral Power Distribution}
(SPD). \par
Un \textit{Corpo Nero} corpo ideale che assorbe ogni tipo di radiazione incidente, indipendentemente da frequenza o angolo di incidenza. In
equilibrio termico, esso emette radiazioni che seguono la \textit{Legge di Planck}\ref{chapter1:planckLaw}. Esso \`e un 
\textit{Radiatore Ideale e diffusore}, cio\`e emette radiazioni uniformemente in tutte le direzioni (superficie lambertiana).\par
per tali corpi neri, l'Emittanza radiante $M_{bb}$ dalla superficie obbedisce alla \textit{Legge di Stefan-Boltzmann}
\begin{equation}
	M_{bb} = \sigma T^4
\end{equation}
dove $\sigma = 5.67032\cdot 10^{-8} \si{W/(m^2 K^4)}$ costante di Stefan-Boltzmann\\
Dunque tale corpo nero \`e una superficie opaca (trasmittanza nulla), perfettamente assorbente (absorptance unitaria) che non riflette alcuna radiazione
incidente (riflettanza nulla). Ci\`o vuol dire che emette tutta la radiazione che assorbe ($A+R+T=1$).\par
Essendo una superficie lambertiana, anche la radianza emessa deve essere constante. Sapendo che un emisfera unitaria ha integrale pari a $\pi$,
\begin{equation}
	M_{bb\lambda} = \pi L_{bb\lambda}
\end{equation}
In equilibrio termico, tale radianza ha espressione detta \textit{Legge di Planck}
\begin{equation}\label{chapter1:planckLaw}
	L_{bb\lambda}(T,\lambda) = \frac{2hc^2}{\lambda^5\left(e^{\frac{hc}{\lambda kT}}-1\right)}
\end{equation}
dove
\begin{align}
	h &= 6.626176\cdot 10^{-34} \si{J/s}\text{ costante di Planck}\\
	k &= 1.380662\cdot 10^{-23} \si{J/K}\text{ costante di Boltzmann}
\end{align}
\`E facile dimostrare come, integrando nell'emisfera unitaria, si ottiene un emittanza radiante corrispondente alla legge di Stefan-Boltzmann\par
Tali corpi neri si dimostrano utili non solo come modelli per parametrizzare, tramite temperatura, una sorgente luminosa, ma risultano rilevanti 
anche per la colorimetria, in quanto costituenti il luogo plankiano.\par
